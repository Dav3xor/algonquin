<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <link rel="stylesheet" href="/static/algonquin.css">

    <title>{{ config.site_name }}</title>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark d-none fixed-top" id="navbar">
      <a class="navbar-brand" href="#">
        <span><canvas id="lissajous" width=30 height=30></canvas></span>
        Algonquin
      </a>
      <button class="navbar-toggler" type="button"
              data-toggle="collapse" data-target="#navb" aria-expanded="false">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navb">
        <ul class="navbar-nav mr-auto" style="padding-top:1.2rem">
          <li class="nav-item dropdown active" id="messages-nav">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" id="messages_label">messages</a>
            <div class="dropdown-menu" aria-labelledby="room_list" id="room_list">
            </div>
          </li>
          <li class="d-none nav-item" id="messages-deselected-nav">
            <a class="nav-link" onclick="tabs.show('messages');">messages</a>
          </li>
          <li class="nav-item" id="people-nav">
            <a class="nav-link" onclick="tabs.show('people');">people</a>
          </li>
          <li class="nav-item" id="images-nav">
            <a class="nav-link">images</a>
          </li>
          <li class="nav-item" id="audio-nav">
            <a class="nav-link">audio</a>
          </li>
          <li class="nav-item" id="search-nav">
            <a class="nav-link">search</a>
          </li>
          <li class="nav-item" id="about-nav">
            <a class="nav-link">about</a>
          </li>
          <li class="nav-item" id="settings-nav">
            <a class="nav-link" onclick="tabs.show('settings');">settings</a>
          </li>
          <li class="nav-item" id="invite-nav">
            <a class="nav-link" onclick="tabs.show('invite');">invite</a>
          </li>
        </ul>
        <form class="form-inline" id="logout">
          <button class="btn btn-warning btn-sm" onclick="send_logout();" type="button">
            Logout
          </button>
        </form>
    </div>

  </nav>
    <div id="footer" class="navbar navbar-dark bg-dark fixed-bottom d-none">
      <form class="form-inline my-1" id="write_message">
        <textarea class="form-control" name="new-message" id="new-message" cols=60 rows="1"></textarea>
        <button class="btn btn-light btn-sm ml-2" id="message-expand-button" 
                type="button" onclick="messages.resize_input();">
        </button>
        <button class="btn btn-warning btn-sm ml-2" type="button" id="new-file">
        <button class="btn btn-success btn-sm ml-2" onclick="send_message();" id="send-message" type="button">
          <span>Send</span>
        </button>
      </form>
    </div>

    <div id="new-user" class="modal" data-keyboard="false" data-backdrop="static" tabindex="-1">
      <div class="modal-dialog modal-light">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Welcome!</h5>
          </div>
          <div class="modal-body">
            <div class="login-banner">
              {{ config.site_name }}
            </div>
            <p>
              Slow Pizza is a <i>small scale</i> and <i>personal</i> chat service for me and my friends.
            </p>
            <p>
              You are more than welcome to use this site without a password on this computer for up to a year, 
              but you'll probably want to enter a password below.
            </p>
            <p>
              You can enter a password at any other time under the settings tab.
            </p>
            <form "form-inline" onsubmit="return false;">
              <div class="form-group">
                <label for="new-password">Password:</label>
                <input type="password" class="form-control" name="new-password" id="new-password" placeholder="Password" required>
              </div>
              <div class="pb-2">
                <button onclick="$('#new-user').modal('hide');" type="button" class="btn btn-success btn-sm">Ok</button>
              </div>
            </form>
            <div class="modal-footer">
              <div class="float-right"> 
                <span class="badge badge-secondary badge-dark">
                  <div class="float-right">Brought to you by:</div>
                  <div class="login-logo-banner"><a href="https://www.github.com/Dav3xor/algonquin">Algonquin</a></div>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="login" class="modal" data-keyboard="false" data-backdrop="static" tabindex="-1">
      <div class="modal-dialog modal-light">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Login</h5>
          </div>
          <div class="modal-body">
            <div class="login-banner">
              {{ config.site_name }}
            </div>
            <form "form-inline" onsubmit="return false;">
              <div class="form-group">
                <label for="email">Email:</label>
                <input type="text" class="form-control" name="email" placeholder="Email" id="email" required>
              </div>
              <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" name="password" id="password" placeholder="Password" required>
              </div>
              <div class="pb-2"><button id="do-login" onclick="send_login_email();" type="button" class="btn btn-success btn-sm">Login</button></div>
            </form>
            <div class="alert alert-danger d-none" id="login-result-status">
              Login Failed
            </div>
            <div class="modal-footer">
              <div class="float-right"> 
                <span class="badge badge-secondary badge-dark">
                  <div class="float-right">Brought to you by:</div>
                  <div class="login-logo-banner"><a href="https://www.github.com/Dav3xor/algonquin">Algonquin</a></div>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div ondrop="drop_handler(event)" 
         ondragover="dragover_handler(event)" 
         class="messages container-fluid d-none" 
         id="messages">
    </div>

    <div class="container-fluid d-none" id="people">
    </div>


    <div class="container-fluid d-none" id="settings">
      <div class="row">
        <div class="col-6">
          <form "form-inline" autocomplete="off" onsubmit="return false;">
            <div class="form-group">
              <label autocomplete="nope" for="settings-handle">Handle:</label>
              <input type="text" class="form-control" 
                     oninput="settings.allow_submission();"
                     name="settings-handle" id="settings-handle" required>
            </div>
            <div class="form-group">
              <label for="settings-email">Email:</label>
              <input autocomplete="nope" type="text" class="form-control" 
                     oninput="settings.allow_submission();"
                     name="settings-email" id="settings-email" required>
            </div>
            <div class="form-group">
              <label for="settings-password">Old Password (if set):</label>
              <input autocomplete="new-password" type="password" class="form-control" 
                     oninput="settings.allow_submission();"
                     name="settings-old-password" id="settings-old-password" required>
            </div>
            <div class="form-group">
              <label for="settings-password">New Password:</label>
              <input autocomplete="new-password" type="password" class="form-control" 
                     oninput="settings.allow_submission();"
                     name="settings-new-password" id="settings-new-password" required>
            </div>
            <div class="form-group">
              <label for="settings-about">About You:</label>
              <textarea class="form-control" name="settings-about" id="settings-about" cols=60 rows="5"
                     oninput="settings.allow_submission();"
                     required></textarea>
            </div>
            <button onclick="settings.send_settings();" 
                    type="button" id="change-settings" 
                    class="btn btn-success btn-lg" disabled>
              Change Settings
            </button>
          </form>
        </div>
        <div class="col-1">
        </div>
        <div class="col-4">
          <form "form-inline" id="portrait-form" name="portrait-form" autocomplete="off" onsubmit="return false;">
            <div class="form-group">
              <img style="padding-top: 100px;" width="100%" id="portrait-image" src="/static/portraits/user-1.png"/>
            </div>
            <div class="form-group">
              <input type="file" class="custom-file-label" 
                     name="portrait-image" id="portrait-file" required>
              <label for="settings-portrait">Filename</label>
            </div>
            <div class="form-group">
              <button onclick="settings.send_portrait();" 
                      type="button" id="change-portrait" 
                      class="btn btn-success btn-lg">
                Change Portrait
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="row d-none" id="settings-result">
        <div class="col-4"><h1>Settings Result:</h1></div>
        <div class="col-6">
          <div class="alert alert-danger" id="settings-result-status">
            User Created Successfully
          </div>
        </div>
      </div>
    </div>


    <div class="container-fluid d-none" id="invite">
      <form "form-inline" autocomplete="off" onsubmit="return false;">
        <div class="row">
          <div class="col">
            <div class="form-group">
              <label for="invite-message">Message:</label>
              <textarea class="form-control" name="invite-message" id="invite-message" rows="20"></textarea>
            </div>
          </div>
          <div class="col-6">
            <div class="form-group">
              <label for="invite-email">New User Email:</label>
              <input autocomplete="nope" type="text" class="form-control" 
                     oninput="invite.allow_submission();"
                     name="invite-email" id="invite-email" required>
            </div>
            <div class="form-group">
              <label for="invite-handle">New User Handle:</label>
              <input type="text" class="form-control" 
                     oninput="invite.allow_submission();"
                     name="invite-handle" id="invite-handle" required>
            </div>
            <div class="form-group">
              <label for="password">New User Password:</label>
              <input autocomplete="new-password" type="password" 
                     oninput="invite.allow_submission();"
                     class="form-control" name="invite-password" id="invite-password">
              <div><b>Note:</b> You can leave the password blank, and the user can enter it in later.</div>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="invite-send-email">
              <label class="form-check-label" for="send-email">Send Email Invite</label>
            </div>
            <div class="pb-2">
              <button onclick="invite.create_user();" 
                      type="button" id="add-user" 
                      class="btn btn-success btn-lg" disabled>
                Add User
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div class="container-fluid d-none" id="invite-result">
      <div class="row">
        <div class="col-4"><h1>Invite Result:</h1></div>
        <div class="col-6"><div class="alert alert-danger" id="invite-result-status">User Created Successfully</div></div>
      </div>
      <div class="row " id="invite-result-message">
        <div class="col-2">
          Message:
        </div>
        <div class="col-7">
          <div class="alert alert-dark" 
               role="alert" 
               id="invite-result-message-text">
            message text
          </div>
        </div>
      </div>
      <div class="row " id="invite-result-url">
        <div class="col-2">
          Bare Url:
        </div>
        <div class="col-7">
          <div class="alert alert-dark" 
               role="alert" 
               id="invite-result-url-text">
            url text
          </div>
        </div>
      </div>
    </div>    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.5/socket.io.min.js" 
            integrity="sha512-L9L4VhE0D58fCxtJiYDHbIzSVfNGY24rhQPWTZPschTVKLpucPsLeT0FSjfnylLYARalTQqgwXsjjhi+wUTwIw==" 
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" 
            crossorigin="anonymous"></script>
    <script src="/static/showdown.js"></script>
    <script src="/static/algonquin.js"></script>

  </body>
</html>

